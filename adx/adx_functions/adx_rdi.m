function rdi = adx_rdi(a, Di, small_delta, capital_delta)
% function rdi = adx_rdi(a, di, small_delta, capital_delta)
%
% Cylindrial geometry!

td = capital_delta - small_delta / 3;
radii = a/2;

ip = small_delta.*Di  ./ (radii).^2;
iq = (td + small_delta/3).*Di ./ (radii).^2;

k_sgp2 = van_gelderen(ip,iq);

rdi = (2*radii).^2 .* k_sgp2(:) / 2 ./ td(:);


end


function k_sgp2 = van_gelderen(p_list, q_list)
% p = delta*D/r2
% q = DELTA*D/r2

mj1 = local_mj1_150();


a2 = (mj1.^2)';
a6 = a2.^3 .* (a2 - 1);
x = p_list * a2;
y = q_list * a2;

k_sgp2 = sum((...
    +2 * x ...
    -2 ...
    +2 * exp(-x) ...
    +2 * exp(-y) ...
    - exp(+x-y) ...
    - exp(-x-y) ) ./ (p_list.^2 * a6), 2);
    
end

function mj1 = local_mj1_150()

mj1 = [1.8411837813406595198983950467663817107677459716796875
    5.33144277352503248579296268871985375881195068359375
    8.5363163663462859886976730194874107837677001953125
    11.70600490259206338805597624741494655609130859375
    14.8635886339090337315838041831739246845245361328125
    18.015527862681803838995620026253163814544677734375
    21.16436985918878832535483525134623050689697265625
    24.311326857210776353213077527470886707305908203125
    27.457050571059244958860290353186428546905517578125
    30.60192297266909378095078864134848117828369140625
    33.7461828986673850749866687692701816558837890625
    36.8899874092368094125049537979066371917724609375
    40.033444053350677904745680280029773712158203125
    43.17662896544882045191116048954427242279052734375
    46.31959756117391435736863058991730213165283203125
    49.46239113970275269593912526033818721771240234375
    52.60504111155668027777210227213799953460693359375
    55.7475717922510085600151796825230121612548828125
    58.89000229918570283871304127387702465057373046875
    62.03234787066198663296745507977902889251708984375
    65.1746208025444531131142866797745227813720703125
    68.3168311259518077349639497697353363037109375
    71.4589871058509942258751834742724895477294921875
    74.601095613456408273123088292777538299560546875
    77.7431624081967669326331815682351589202880859375
    80.885192353878437643288634717464447021484375
    84.027189586293530965122045017778873443603515625
    87.1691576445402773742898716591298580169677734375
    90.3110995749034231039331643842160701751708984375
    93.4530180137600297030076035298407077789306640625
    96.5949152542911377850032295100390911102294921875
    99.7367933005739217833252041600644588470458984375
    102.8786539117544549526428454555571079254150390625
    106.020498638360805898628314025700092315673828125
    109.16232885234086324999225325882434844970703125
    112.30414577205505111123784445226192474365234375
    115.4459504831855696238562813960015773773193359375
    118.5877439563199260419423808343708515167236328125
    121.7295270618102023263418232090771198272705078125
    124.8713005823878887667888193391263484954833984375
    128.013065223920278867808519862592220306396484375
    131.1548216246201263857074081897735595703125
    134.296570362962114586480311118066310882568359375
    137.438311964512962504159077070653438568115234375
    140.58004690784537160652689635753631591796875
    143.721775629675988739109016023576259613037109375
    146.863498529343786458412068895995616912841796875
    150.00521597272523877109051682054996490478515625
    153.1469282956676352114300243556499481201171875
    156.28863580700812008217326365411281585693359375
    159.430338791235527651224401779472827911376953125
    162.57203751084369969248655252158641815185546875
    165.713732208416871571898809634149074554443359375
    168.85542310848228453323827125132083892822265625
    171.997110419159724870041827671229839324951171875
    175.138794333633285305040772072970867156982421875
    178.280475031467773305848822928965091705322265625
    181.422152679788069917776738293468952178955078125
    184.5638274343381226572091691195964813232421875
    187.70549944043358436829294078052043914794921875
    190.84716883382014884773525409400463104248046875
    193.988835741448866656355676241219043731689453125
    197.130500282176768678255029954016208648681640625
    200.2721625674020060614566318690776824951171875
    203.413822701639986689770012162625789642333984375
    206.5554807830466188534046523272991180419921875
    209.697136903895028581246151588857173919677734375
    212.838791151009672830696217715740203857421875
    215.980443606162651803970220498740673065185546875
    219.1220943464360288999159820377826690673828125
    222.26374344455325626768171787261962890625
    225.40539096918297445881762541830539703369140625
    228.547036985217829396788147278130054473876953125
    231.68868155403032460526446811854839324951171875
    234.830324733708522444430855102837085723876953125
    237.971966579272674380263197235763072967529296875
    241.11360714287530981891904957592487335205078125
    244.255246473985522470684372819960117340087890625
    247.396884619559358498008805327117443084716796875
    250.53852162419758542455383576452732086181640625
    253.68015753029129655260476283729076385498046875
    256.8217923781572835650877095758914947509765625
    259.96342620616320573390112258493900299072265625
    263.10505905084420419370871968567371368408203125
    266.2466909470107339075184427201747894287109375
    269.3883219278494607351603917777538299560546875
    272.52995202501648464021855033934116363525390625
    275.67158126872487855507642962038516998291015625
    278.813209687825974469888024032115936279296875
    281.95483730988502202308154664933681488037109375
    285.09646416125224277493543922901153564453125
    288.23809026712882541687577031552791595458984375
    291.37971565162928300196654163300991058349609375
    294.52134033783903532821568660438060760498046875
    297.6629643478687512470060028135776519775390625
    300.804587702905564583488740026950836181640625
    303.94621042326042470449465326964855194091796875
    307.08783252841311650627176277339458465576171875
    310.22945403705438138786121271550655364990234375
    313.3710749671253097403678111732006072998046875
    316.51269533585474391657044179737567901611328125
    319.65431515979418009010259993374347686767578125
    322.795934454850566908135078847408294677734375
    325.93755323631779674542485736310482025146484375
    329.079171518905468474258668720722198486328125
    332.22078931676691126995137892663478851318359375
    335.3624066435249915230087935924530029296875
    338.50402351229689656975097022950649261474609375
    341.645639935717326807207427918910980224609375
    344.78725592596043725279741920530796051025390625
    347.92887149476058539221412502229213714599609375
    351.070486653432226376025937497615814208984375
    354.21210141288821660054964013397693634033203125
    357.353715783657889915048144757747650146484375
    360.49532977590325799610582180321216583251953125
    363.6369433994353812522604130208492279052734375
    366.77855666372897758265025913715362548828125
    369.92016957793703113566152751445770263671875
    373.06178215090403682552278041839599609375
    376.203394391179244848899543285369873046875
    379.345006307028597802855074405670166015625
    382.486617906446326742297969758510589599609375
    385.62822919716637670717318542301654815673828125
    388.769840186672581694438122212886810302734375
    391.91145088220872594320098869502544403076171875
    395.05306129078832100276486016809940338134765625
    398.19467141920341646255110390484333038330078125
    401.3362812740334675254416652023792266845703125
    404.47789086165340677325730212032794952392578125
    407.619500188241772775654681026935577392578125
    410.7611092597879860477405600249767303466796875
    413.9027180820995681642671115696430206298828125
    417.04432666080919034357066266238689422607421875
    420.18593500138098306706524454057216644287109375
    423.32754310911678885531728155910968780517578125
    426.4691509891623582007014192640781402587890625
    429.6107586465128633790300227701663970947265625
    432.75236608601841226118267513811588287353515625
    435.89397331238927790764137171208858489990234375
    439.03558033020095763276913203299045562744140625
    442.17718714389883416515658609569072723388671875
    445.318793757802950494806282222270965576171875
    448.46040017611221628612838685512542724609375
    451.602006402908727977774105966091156005859375
    454.74361244216169097853708080947399139404296875
    457.8852182977315123935113660991191864013671875
    461.02682397337326847264193929731845855712890625
    464.168429472740399432950653135776519775390625
    467.31003479938817690708674490451812744140625
    470.45163995677677348794532008469104766845703125];
end